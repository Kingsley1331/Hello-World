<!DOCTYPE html>
<html>
<head>
<style type="text/css">
//html{height:100%;}
body {
 margin: 0px;
 padding: 0px;
 //overflow:hidden;
 //overflow-y:auto;
 //overflow-x:hidden;
 //overflow:-moz-scrollbars-none;
}
::-webkit-scrollbar { display: none; }

canvas{
position:absolute;
//position:relative;
//top:-50px;
//border: 1px solid black;
z-index:0;
//margin:0px;
//padding:0px;
}
h1{
position:relative;
}
#wrapper{
min-width:1870px;
//width:100%;
}
#circle{
 text-align:center;
}
ul{
list-style-type:none;
font-size:20px
}
#canvasImg{
position:absolute;
//position:relative;
top:50px;
border: 1px solid grey;
visibility:hidden;
margin: 0px;
box-shadow:5px 5px 10px #888888;
width:300px; 
//left:-300px;
}
.shapes{
border-right : 1px solid #404040;
width:60px;
height:50px;
float:left;
text-align:center;
padding-left: 10px;
padding-right: 10px;
background-color:black; 
background: -webkit-linear-gradient(bottom, black , #404040); /* For Safari */
background: -o-linear-gradient(bottom, black , #404040); /* For Opera 11.1 to 12.0 */
background: -moz-linear-gradient(bottom, black , #404040 ); /* For Firefox 3.6 to 15 */
background: linear-gradient(to bottom, #404040, black); /* Standard syntax (must be last) */
cursor:pointer;
z-index:0;
}

.icons{
width:30px;
margin-top:10px;
}
#ReShaper{
width:50px;
margin-top:0px;
}

#bar{
//position:relative;
position:absolute;
left:0;
background-color:black;
background: -webkit-linear-gradient(bottom, black , #404040); /* For Safari */
background: -o-linear-gradient(bottom, black , #404040); /* For Opera 11.1 to 12.0 */
background: -moz-linear-gradient(bottom, black , #404040 ); /* For Firefox 3.6 to 15 */
background: linear-gradient(to bottom, #404040, black); /* Standard syntax (must be last) */
height:50px;
margin-top:0;
box-shadow:0px 5px 10px #888888;
z-index:+1;
//width:100%;
}
h2{
position:relative;
top:-50px;
text-align:center;
}
#tips{
//width:500px;
width:800px;
height:710px
border:1px solid black;
position:absolute;
top:75px;
left:50%;
margin-left:-400px;
z-index:+1;
//text-align:center;
background-color:beige;
box-shadow:10px 10px 10px #888888;
border-radius:10px;
visibility:hidden;
//opacity:0.7;
padding:15px;
padding-bottom:0px;
font-family:verdana;
font-size:12px;
}
.tipsDiv{
position:relative;
left:375px;
text-align:center;
background-color:black;
background: -webkit-linear-gradient(bottom, black , #404040); /* For Safari */
background: -o-linear-gradient(bottom, black , #404040); /* For Opera 11.1 to 12.0 */
background: -moz-linear-gradient(bottom, black , #404040 ); /* For Firefox 3.6 to 15 */
background: linear-gradient(to bottom, #404040, black); /* Standard syntax (must be last) */
width:40px;
height:40px;
border-radius:5px;
box-shadow:3px 3px 5px #888888;
text-align:center;
}
.tipsImg{
position:relative;
top:7px;
width:25px;
}
.tipsPara{
//float:left;
}
 
#tipsRemove, #tipsSee{
border: 1px solid grey;
background-color:lightblue;
width:100px;
height:25px;
text-align:center;
border-radius:5px;
padding-top:6px;
box-shadow:3px 3px 10px #888888;
font-size:14px;
}
#tipsRemove:hover{
color:red;
cursor:pointer;
}
#tipsSee{
position:absolute;
right:20px;
top:8px;
font-family:verdana;
display:none;
}
#tipsSee:hover{
color:red;
cursor:pointer;
}

#tipsReshaper{
width:32px;
position:relative;
top:5px;
}
#tipsWrapper{
position:relative;
top:-40px;
}
#tipsTitle{
width:100px;
}
#PickColor{
//background-color: white;
width:80px;
height:80px;
position:relative;
top:50px;
left:8px;
border: 1px solid grey;
visibility:hidden;
z-index:+1;
box-shadow:5px 5px 10px #888888;
//display:none;
}
#ChangeColour{
position:relative;
top:-50px;
left:9px;
}
.pallet{
width:15px;
height:15px;
position:relative;
top:-100px;
box-shadow:1px 1px 2px #888888;
}
.pallet:hover{
box-shadow:0px 0px 4px blue;
}

#colourful{
position:relative;
left:720px;
//border: 1px solid white;
width:50px;
height:50px;
}

//table{
//border: 1px solid black;
//position:absolute;
//top:-100px;
//}

#transparent{
border: 1px solid black;
}

#blue{
background-color: blue;
}

#black{
background-color: black;
}

#red{
background-color: red;
}

#green{
background-color: green;
}

#red{
background-color: red;
}

#yellow{
background-color: yellow;
}

#white{
background-color: white;
}

#lightblue{
background-color: lightblue;
}

#lightgreen{
background-color: lightgreen;
}

#orange{
background-color: orange;
}

#purple{
background-color: purple;
}

#violet{
background-color: violet;
}

#beige{
background-color: beige;
}

#aqua{
background-color: aqua;
}

#pink{
background-color: pink;
}

#grey{
background-color: grey;
}

</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script>
var circle;
var canvas;
var circleArray = [];
var squareArray = [];
var triangleArray = [];
var lineArray = [];
var customShapeArray = [];
var shapes = false;
var circles = false;
var triangles = false;
var squares = false;
var onObject = false;
var dragging = false;
var cursor_grab = "-webkit-grabbing" || "-moz-grabbing" || "grabbing";
var cursor_drag = "-webkit-grab" || "-moz-grab" || "grab";
var mousePos;
var shapeSelection = {circle:[false, circleGen, circleArray], 
     square:[false, squareGen, squareArray],
     triangle:[false, triangleGen, triangleArray],
     customShape:[false, customShapeGen, customShapeArray]
     };
var triangle;
var square;
var shapeCounter = 0;
var deletion = false;
var reSize = false;
var reShape = false;
var onReshape = false;
var expand = false;
var colourChange = false;
var selectSize = 15; // resize: the shortest distance between the radius 
var smallBox = 9; // size of the small black square in the expansion square
var colours = {transparent:['transparent', false], blue:['blue', false], red:['red', false], yellow:['yellow', false]
     , green:['green', false], white:['white', false], black:['black', false]
     , lightblue:['lightblue', false], lightgreen:['lightgreen', false], orange:['orange', false]
     , purple:['purple', false], violet:['violet', false], beige:['beige', false]
     , aqua:['aqua', false], grey:['grey', false], pink:['pink', false]
     }
    
var rotate = false;
var onSlider = false;
var sliderPosition = 0;
var sliderButtonWidth = 250;
var startDraw = false;
var customDrawer = {start:[0,0], end:[0,0]};
//var pointsArray = [[0,0],[0,0]];
var pointsArray = [];
var closedPath = false;
var closePathRadius = 5;
var startDraw = false;
var rotVertices = 0;
var counter = 0;
var saving = false;
var screenWidth = screen.availWidth;
var screenHeight = screen.availHeight;
var tipping = true;
var offcenter = [0,0];
var select = false;

$(document).ready(function(){
  $("#tipsRemove").click(function(){
    $("#tips").fadeOut("slow");
 $("#tipsSee").fadeIn("slow");
  });
})

$(document).ready(function(){
  $("#tipsSee").click(function(){
    $("#tipsSee").fadeOut("slow");
 $("#tips").fadeIn("slow");
  });
})
function distance(x,y){
  return Math.sqrt(x*x + y*y);
}
function angleFinder(x1,y1,x2,y2){  
 var product = x1*x2 + y1*y2;
 var mag = distance(x1,y1)*distance(x2,y2);
 return Math.acos(product/mag);
 }
 
function angleCalc(x1,y1,x2,y2){
 var theta = angleFinder(Math.abs(x1),Math.abs(y1),Math.abs(x2),Math.abs(y2));
 if((y1 >= 0 && x1 >=0) || (y1 >= 0 && x1 <=0)) {
  var product = x1*x2 + y1*y2;
  var mag = distance(x1,y1)*distance(x2,y2);
  return Math.acos(product/mag);
 }
 if(y1 <= 0 && x1 <= 0){
  var product = x1*x2 + y1*y2;
  var mag = distance(x1,y1)*distance(x2,y2);
  return Math.PI + theta;
   
 }else if(y1 <= 0 && x1 >=0){
  var product = x1*x2 + y1*y2;
  var mag = distance(x1,y1)*distance(x2,y2);
  return 2*Math.PI - theta;
 }
}
 
function rotater2(center_x, center_y, point_x, point_y, angle){
 var length = distance(point_x - center_x, point_y - center_y);
 var angle_1 = angleCalc(point_x - center_x, point_y - center_y, length, 0);
 var totalAngle = angle_1 + angle;
 var x_change = center_x + length*Math.cos(totalAngle) - point_x;
 var y_change = center_y + length*Math.sin(totalAngle) - point_y;
 return [x_change, y_change];
}
function init(){
//console.log(screenWidth + ' ' + screenHeight);
 if(tipping){tips.style.visibility = 'visible';}
 mousePos = 0;
 canvas = document.getElementById('canvas');
 context = canvas.getContext('2d');
 
 /*context.canvas.width = screenWidth;
 context.canvas.height = screenHeight - 50; //the navigation bar has a height of 50 pixels
 */
 
 canvas.width = window.innerWidth;
 
 
 //canvas.height = window.innerHeight;
 canvas.height = window.screen.height;
 
 
 body = document.getElementById('body');
 //body.width = window.screen.height*2;
 //console.log(body.width);
 
 bar = document.getElementById('bar');
 bar.style.width = window.innerWidth + 'px';;
 //console.log(bar.style.width);
 
 tips = document.getElementById('tips');
 //tips.style.left = screenWidth/2 - 400 + 'px';
 
 bufferCanvas = document.createElement('canvas');
    bufferCtx = bufferCanvas.getContext("2d");
    bufferCtx.canvas.width = context.canvas.width;
    bufferCtx.canvas.height = context.canvas.height;
 
 options();
 //locate();
 mouseMove();
 mouseDown();
 mouseUp();
 eraser();
 animate();
}
function options(){
 circle = document.getElementById('circle');
 square = document.getElementById('square');
 triangle = document.getElementById('triangle');
 ReSize = document.getElementById('Re-Size');
 ReShape = document.getElementById('Re-Shape');
 Rotate = document.getElementById('Rotate');
 ChangeColour = document.getElementById('ChangeColour');
 none = document.getElementById('none');
 erase = document.getElementById('erase');
 save = document.getElementById('save');
 image = document.getElementById('canvasImg')
 customShape = document.getElementById('customShape');
 PickColor = document.getElementById('PickColor');
}

window.requestAnimFrame = (function(callback) {
 return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
 function(callback) {
 window.setTimeout(callback, 1000 / 60);
};
})();

function animate(){
 draw();
 requestAnimFrame(function() {
 animate();
 });
}

/*function locate(){
 canvas.addEventListener('mousemove', function(evt) { // canvas.addEventListener detects mouse movements on the canvas
 mousePos = getMousePos(canvas, evt);
 onObject = false;
 
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius){
    onObject = true;
    if(!dragging){
     canvas.style.cursor = cursor_drag;
    }
   }
  }if(onObject == false){
   canvas.style.cursor = "auto";
   }
  }
 }, false);
}*/
function locate(){
 onObject = false;
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius){
    onObject = true;
    if(!dragging){
     canvas.style.cursor = cursor_drag;
    }
   }
  }if(onObject == false){
   canvas.style.cursor = "auto";
   }
  }
}
function mouseMove(){
 canvas.addEventListener('mousemove', function(evt){
 mousePos = getMousePos(canvas, evt);
 locate();
 selected();
 }, false)
}
function mouseDown(){
 canvas.addEventListener('mousedown', function(evt){
 eraser();
 drag();
 reSizer();
 rotater();
 pointStart();
 reShaper();
 }, false)
}

function mouseUp(){
 canvas.addEventListener('mouseup', function(evt){
 onSlider = false;
 drop();
 stopResize();
 if(reShape){offReshaper();}
 //pointEnd();
 //lineGen();
 }, false)
}

function drag(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius && !dragging && !onReshape){
    offcenter[0] = shapeSelection[key][2][i].X - mousePos.x;
    offcenter[1] = shapeSelection[key][2][i].Y - mousePos.y;
    console.log(offcenter[0], offcenter[1]);
    dragging = true;
    shapeSelection[key][2][i].onObject = true;
    canvas.style.cursor = cursor_grab;
   }
  }
 }
}
function selected(){
 select = false;
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   shapeSelection[key][2][i].selected = false; 
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius && !select){
    shapeSelection[key][2][i].selected = true;
    select = true;
   }
  }
 }
}
 
function drop(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   dragging = false;
   shapeSelection[key][2][i].onObject = false; 
   canvas.style.cursor = cursor_drag; 
  }
 }
}

function eraser(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius && deletion){
    shapeSelection[key][2].splice(i,1);
    //canvas.style.cursor = cursor_grab;
   }
  }
 }
}

function reSizer(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius && reSize){
   /** make sure that only one object at time can be resized **/
   shapeSelection[key][2][i].expandBox = true;
   for(keys in shapeSelection){
    for(var j = 0; j < shapeSelection[keys][2].length; j++){
     if(key != keys){
      shapeSelection[keys][2][j].expandBox = false;}
     else {
      if(j != i){
       shapeSelection[keys][2][j].expandBox = false;
      }
     }
    }
   }
    } 
    
    // detects if cursor is over any of the small expansion boxes at the corners
       /** top-left **/
    if((distance(shapeSelection[key][2][i].X - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.x, shapeSelection[key][2][i].Y - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.y) <= smallBox/2 ||
       /** bottom-right **/
     distance(shapeSelection[key][2][i].X + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.x, shapeSelection[key][2][i].Y + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.y) <= smallBox/2 ||
       /** top-right **/
     distance(shapeSelection[key][2][i].X + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.x, shapeSelection[key][2][i].Y - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.y) <= smallBox/2 ||
       /** bottom-left **/
     distance(shapeSelection[key][2][i].X - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.x, shapeSelection[key][2][i].Y + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.y) <= smallBox/2
    
    )&& shapeSelection[key][2][i].expandBox){
     shapeSelection[key][2][i].expand = true;
     canvas.style.cursor = cursor_grab;
    }
    
    
    // detects if cursor is over any of the small expansion boxes at the right and left handsides
       /** left **/
    if((distance(shapeSelection[key][2][i].X - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= smallBox/2 ||
       /** right **/
     distance(shapeSelection[key][2][i].X + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= smallBox/2
    
    ) && shapeSelection[key][2][i].expandBox){
     if(key == 'customShape'/* temporary condition*/){shapeSelection[key][2][i].h_expand = true;}
     canvas.style.cursor = cursor_grab;
    }
    
    
    // detects if cursor is over any of the small expansion boxes at the top and bottom sides
       /** top **/
    if((distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - shapeSelection[key][2][i].stretchRadius - selectSize - mousePos.y) <= smallBox/2 ||
       /** bottom **/
     distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y + shapeSelection[key][2][i].stretchRadius + selectSize - mousePos.y) <= smallBox/2
  
    )&& shapeSelection[key][2][i].expandBox){
     if(key == 'customShape'/* temporary condition*/){shapeSelection[key][2][i].v_expand = true;}
     canvas.style.cursor = cursor_grab;
    }
   }
  }
 }
function stopResize(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   expand = false;
   if(shapeSelection[key][2][i].v_expand || shapeSelection[key][2][i].h_expand){shapeSelection[key][2][i].stretchRadius = shapeSelection[key][2][i].radius;}
    shapeSelection[key][2][i].expand = false;
    shapeSelection[key][2][i].v_expand = false; 
    shapeSelection[key][2][i].h_expand = false; 
    //canvas.style.cursor = cursor_drag; 
   }
  }
 }
/** pointStart() adds points to the pointsArray on mousedown **/
function pointStart(){
 if(shapes && !onObject){
  startDraw = true;
  if(!closedPath){
   pointsArray.push([mousePos.x, mousePos.y]);
  }else{
   pointsArray.push([pointsArray[0][0], pointsArray[0][1]]); // adds the coordinates of the first point to the pointsArray again when clicking on them in order to closePath
   startDraw = false;
  }
 }
}

function rotater(){
 for(key in shapeSelection){
  for(var i = 0; i < shapeSelection[key][2].length; i++){
   if(distance(shapeSelection[key][2][i].X - mousePos.x, shapeSelection[key][2][i].Y - mousePos.y) <= shapeSelection[key][2][i].radius && rotate){
    if(!shapeSelection[key][2][i].rotationLine){            //sets the global sliderPosition equal to the objects sliderPosition
     sliderPosition = shapeSelection[key][2][i].sliderPosition;
    }
   
   shapeSelection[key][2][i].rotationLine = true;
   // make sure that only one object at time can be rotated 
   for(keys in shapeSelection){
    for(var j = 0; j < shapeSelection[keys][2].length; j++){
     if(key != keys){
      shapeSelection[keys][2][j].rotationLine = false;
     }
     else{
      if(j != i){
       shapeSelection[keys][2][j].rotationLine = false;
      }
     }
    }
   }
    } // detects if cursor is hovering over slider
    if(distance(shapeSelection[key][2][i].slider[0] - mousePos.x, shapeSelection[key][2][i].slider[1] - mousePos.y) <= 10){
     onSlider = true;
    }
   }
  }
 }
/** this function detects whether or not a user has clicked on a vertex **/
function reShaper(){
 if(reShape){
  for(var i = 0; i < customShapeArray.length; i++){
   var rotChange = customShapeArray[i].rotater3(customShapeArray[i].sliderPosition);
   
   for(var j = 0; j < customShapeArray[i].vertices.length; j++){
    customShapeArray[i].vertices[j][2] = false;
    
    var Xpoint = customShapeArray[i].vertices[j][0] + customShapeArray[i].X;
    var Ypoint = customShapeArray[i].vertices[j][1] + customShapeArray[i].Y;
    
    var Xchange = rotChange[j][0];
    var Ychange = rotChange[j][1];
    
    if(distance(Xpoint + Xchange - mousePos.x, Ypoint + Ychange - mousePos.y)< 5){
     customShapeArray[i].vertices[j][2] = true;
    }
   }
  } 
 }
}

function offReshaper(){
  var centralDifference = [0,0];
  for(var i = 0; i < customShapeArray.length; i++){
  /** this section calculates the coordinates of the centroid **/
  customShapeArray[i].centroid = [0,0]; 
  for(var k = 0; k < customShapeArray[i].pointsArray.length; k++){
   if(k == 0){continue;}else{
   // we need to use coordinates of the rotated vertices in order to calculate the new position for the centroid
   var projection = rotater2(0, 0, customShapeArray[i].vertices[k][0], customShapeArray[i].vertices[k][1], customShapeArray[i].sliderPosition*2*Math.PI/sliderButtonWidth);
   
   customShapeArray[i].centroid[0] += customShapeArray[i].X + customShapeArray[i].vertices[k][0] + projection[0];
   customShapeArray[i].centroid[1] += customShapeArray[i].Y + customShapeArray[i].vertices[k][1] + projection[1];
   }
  }
  customShapeArray[i].centroid[0] /= (customShapeArray[i].pointsArray.length - 1);
  customShapeArray[i].centroid[1] /= (customShapeArray[i].pointsArray.length - 1);
 
  // the code below calculates the difference between the centroid and the current position of the center (X,Y)
  centralDifference[0] = customShapeArray[i].centroid[0] - customShapeArray[i].X;
  centralDifference[1] = customShapeArray[i].centroid[1] - customShapeArray[i].Y;
 
  var rotDifference_x = 0;
  var rotDifference_y = 0;
 
  
  var projection = [0,0];
  if(distance(centralDifference[0], centralDifference[1]) > 0){         // the difference needs to be rotated to match the vertices so that it can be subtracted from them
   projection = rotater2(0, 0, centralDifference[0], centralDifference[1], -customShapeArray[i].sliderPosition*2*Math.PI/sliderButtonWidth);
  }
  var rotDifference_x = centralDifference[0] + projection[0];
  var rotDifference_y = centralDifference[1] + projection[1];
   
  // this difference is subtracted from the vertices so that they do not move when the X,Y values are eventually updated (by setting them equal to the centroid)
  for(var m = 0; m < customShapeArray[i].pointsArray.length; m++){
   customShapeArray[i].vertices[m][0] -= rotDifference_x;
   customShapeArray[i].vertices[m][1] -= rotDifference_y;
  }
  
  /** the shape's X and Y properties are set equal to the centroid **/ 
  //the vertices remain in the same position because the difference has been subtracted from them
  customShapeArray[i].X = customShapeArray[i].centroid[0];
  customShapeArray[i].Y = customShapeArray[i].centroid[1];
 
  for(var j = 0; j < customShapeArray[i].vertices.length; j++){
   customShapeArray[i].vertices[j][2] = false;
   }
  }
}
function writeMessage(canvas, message) { // canvas.addEventListener sets the value of message
 context.font = '18pt Calibri';
 context.fillStyle = 'black';
 context.fillText(message, canvas.width/2, 25);
}
 
function getMousePos(canvas, evt) {       //canvas.addEventListener uses this function to calculate mouse position
 var rect = canvas.getBoundingClientRect();
 return {
  x: evt.clientX - rect.left,
  y: evt.clientY - rect.top
  };
 }

function Circle(){
 this.radius = 30;
 this.stretchRadius = 30;
 this.defaultRadius = 30;
 this.X = 0;
 this.Y = 0;
 this.colour = 'lightblue';
 this.onObject = false;
 this.expand = false;
 this.expandBox = false;
 this.slider = [0,0];
 this.selected = false;
 /*this.resize = function(){
  var gap = Math.sqrt(2*(this.radius + selectSize )*(this.radius + selectSize)) - this.radius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.radius < 5){this.radius = 4}
 }*/
 
 this.resize = function(){
  var gap = Math.sqrt(2*(this.stretchRadius + selectSize )*(this.stretchRadius + selectSize)) - this.stretchRadius;
  this.stretchRadius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.stretchRadius < 5){this.stretchRadius = 4}
 }
 
 this.pickColour = function(){
  this.colour = chooseColour();
 }
 this.rotationLine = false;
}
function circleGen(){
 if(onObject == false){
  circle = new Circle();
  circle.X = mousePos.x;
  circle.Y = mousePos.y;
  circleArray[circleArray.length] = circle;
 }
}

function Square(){
 this.side = 55;
 this.defaultSide = 55;
 this.X = 0;
 this.Y = 0;
 this.radius = 2*this.side/3;
 this.stretchRadius = 2*this.side/3;
 this.colour = 'lightblue';
 this.onObject = false;
 this.expand = false;
 this.expandBox = false;
 this.selected = false;
 /*this.resize = function(){
  var gap = Math.sqrt(2*(this.radius + selectSize )*(this.radius + selectSize)) - this.radius;
  this.side *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.radius < 5){this.radius = 5}
  if(this.side < 8){this.side = 8}
 }*/
 
 this.resize = function(){
  var gap = Math.sqrt(2*(this.stretchRadius + selectSize )*(this.stretchRadius + selectSize)) - this.stretchRadius;
  this.side *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
  this.stretchRadius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.stretchRadius < 5){this.stretchRadius = 5}
  if(this.side < 8){this.side = 8}
 }
 
 this.pickColour = function(){
  this.colour = chooseColour();
 }
 this.sliderPosition = 0;
 this.rotationLine = false;
 this.slider = [0,0];
 
 this.rotater3 = function(sliderPosition){
 
  var pointOne = [this.X - this.side/2, this.Y + this.side/2];
  var pointTwo = [this.X + this.side/2, this.Y + this.side/2];
  var pointThree = [this.X + this.side/2, this.Y - this.side/2];
  var pointFour = [this.X - this.side/2, this.Y - this.side/2];
  
  var rotPointOne = rotater2(this.X, this.Y, pointOne[0], pointOne[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  var rotPointTwo = rotater2(this.X, this.Y, pointTwo[0], pointTwo[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  var rotPointThree = rotater2(this.X, this.Y, pointThree[0], pointThree[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  var rotPointFour = rotater2(this.X, this.Y, pointFour[0], pointFour[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  
  return [rotPointOne, rotPointTwo, rotPointThree, rotPointFour];
 }
}

function squareGen(){
 if(onObject == false){
  square = new Square();
  square.X = mousePos.x;
  square.Y = mousePos.y;
  squareArray[squareArray.length] = square;
 }
}

function Triangle(){
 this.side = 60;
 this.defaultSide = 60
 this.X = 0;
 this.Y = 0;
 this.radius = 2*this.side/3;
 this.stretchRadius = 2*this.side/3;
 this.colour = 'lightblue';
 this.onObject = false; // determines whether or not the curso is hovering over a shape
 this.expand = false; // determines whether or not a shape is currently being expanded
 this.expandBox = false;
 this.selected = false;
 /*this.resize = function(){
  var gap = Math.sqrt(2*(this.radius + selectSize )*(this.radius + selectSize)) - this.radius;
  this.side *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.radius < 5){this.radius = 5}
  if(this.side < 8){this.side = 8}
 }*/
 
 this.resize = function(){
  var gap = Math.sqrt(2*(this.stretchRadius + selectSize )*(this.stretchRadius + selectSize)) - this.stretchRadius;
  this.side *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
  this.stretchRadius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
  this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius;
  if(this.stretchRadius < 5){this.stretchRadius = 5}
  if(this.side < 8){this.side = 8}
 }
 
 
 this.pickColour = function(){
  this.colour = chooseColour();
 }
 this.sliderPosition = 0;
 this.rotationLine = false;
 this.slider = [0,0];
 
 this.rotater3 = function(sliderPosition){
 
  var pointOne = [this.X - this.side/2, this.Y + Math.sqrt(3)/6 * this.side];
  var pointTwo = [this.X + this.side/2, this.Y + Math.sqrt(3)/6 * this.side];
  var pointThree = [this.X, this.Y - 2 * Math.sqrt(3)/6 * this.side];
  
  var rotPointOne = rotater2(this.X, this.Y, pointOne[0], pointOne[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  var rotPointTwo = rotater2(this.X, this.Y, pointTwo[0], pointTwo[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  
  var rotPointThree = rotater2(this.X, this.Y, pointThree[0], pointThree[1], sliderPosition*2*Math.PI/sliderButtonWidth);
  
  return [rotPointOne, rotPointTwo, rotPointThree];
 }
}

function triangleGen(){
 if(onObject == false){
  triangle = new Triangle();
  triangle.X = mousePos.x;
  triangle.Y = mousePos.y;
  triangleArray[triangleArray.length] = triangle;
 }
}
function Line(){
 this.firstLine = false;
 this.start = [0, 0];
 this.end = [0, 0];
}
function lineGen(){
 line = new Line();
 lineArray[lineArray.length] = line;
}
function CustomShape(){
 this.pointsArray = pointsArray;
 this.centroid = [0, 0];
 this.vertices = [];
 this.X = 0;
 this.Y = 0;
 
 this.scaleFactor = 1
 this.radius = 50;
 this.stretchRadius = 50;
 
 this.onObject = false;
 this.colour = 'lightblue';
 this.onObject = false;
 this.expand = false;
 this.h_expand = false;
 this.v_expand = false;
 this.expandBox = false;
 this.selected = false;
 this.sliderPosition = 0;
 this.rotationLine = false;
 this.slider = [0,0];
 this.pickColour = function(){
  this.colour = chooseColour();
 }
 
 this.resize = function(){
  
  var gap;
  
  var rotVertices_2 = [];
  for(var i = 0; i < this.pointsArray.length; i++){
  
  /** Rotate to match displayed orientation **/
  
   rotVertices_2 = rotater2(0, 0, this.vertices[i][0], this.vertices[i][1], this.sliderPosition*2*Math.PI/sliderButtonWidth);
   this.vertices[i][0] += rotVertices_2[0];
   this.vertices[i][1] += rotVertices_2[1];
   
  /** Apply change of size transformation **/
   
   if(this.expand){
    //gap = Math.sqrt(2*(this.stretchRadius + selectSize)*(this.stretchRadius + selectSize)) - this.stretchRadius;
    gap = Math.sqrt(2)*(this.stretchRadius + selectSize) - this.stretchRadius;
    this.vertices[i][0] *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
    this.vertices[i][1] *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
   }
  
  /** Apply change of size transformation to the horizonal axis **/
  
   if(this.h_expand){
    gap = selectSize;
    this.vertices[i][0] *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
   }
  
  /** Apply change of size transformation to the vertical axis **/
  
   if(this.v_expand){
    gap = selectSize;
    this.vertices[i][1] *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
   }
   
  /** Rotate back to the original orientation **/
  
   rotVertices_2 = rotater2(0, 0, this.vertices[i][0], this.vertices[i][1], -this.sliderPosition*2*Math.PI/sliderButtonWidth);
   this.vertices[i][0] += rotVertices_2[0];
   this.vertices[i][1] += rotVertices_2[1];
  }
  if(this.expand){this.radius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.radius};
  
  this.stretchRadius *= (distance(mousePos.x - this.X, mousePos.y - this.Y) - gap)/this.stretchRadius;
 }
 

this.rotater3 = function(sliderPosition){
 
 var rotVertices = [];
 
 for(var i = 0; i < this.pointsArray.length; i++){ //calculates and returns in the form of an array all the changes that must be applied to the vertices in order to rotate them
  rotVertices[i] = [0,0];
  var rot = rotater2(0, 0, this.vertices[i][0], this.vertices[i][1], sliderPosition*2*Math.PI/sliderButtonWidth);
  rotVertices[i][0] = rot[0];
  rotVertices[i][1] = rot[1];
  }
 return rotVertices;
 }
 
 var j;
 centralize(this, this.pointsArray, j);
}
function customShapeGen(){
 customShape = new CustomShape();
 customShapeArray[customShapeArray.length] = customShape;
}
/** centralize() calculates the centroid and sets the centre (X,Y) of the shape equal to it **/
function centralize(shape, array, i){
 for(var i = 0; i < array.length; i++){
  if(i == 0){continue;}else{
   shape.X += array[i][0];
   shape.Y += array[i][1];
  }
 }
 shape.X /= (array.length - 1);
 shape.Y /= (array.length - 1);
 for(var i = 0; i < array.length; i++){
  shape.vertices[i] = [0,0,false];
  shape.vertices[i][0] = array[i][0] - shape.X;
  shape.vertices[i][1] = array[i][1] - shape.Y;
 }
}

function draw(){
 
 bufferCtx.fillStyle = '#E0E0E0';
 bufferCtx.fillRect(0, 0, canvas.width, canvas.height);
 
 circleDrawer();
 squareDrawer();
 triangleDrawer();
 
         /** this section draws the initial shape before any changes and transformations are applied to it **/
 if(shapes){
  bufferCtx.fillStyle = 'blue';
  bufferCtx.beginPath();
  bufferCtx.arc(mousePos.x, mousePos.y, 2, 0, 2*Math.PI);
  bufferCtx.fill();
  if(startDraw){bufferCtx.moveTo(pointsArray[0][0], pointsArray[0][1]);} // first point of the custom shape is drawn here
  
  closedPath = false;
  for(var i = 0; i < pointsArray.length; i++){
   if(i != 0){
    bufferCtx.lineTo(pointsArray[i][0], pointsArray[i][1]); // all the other points are drawn here
   }
  }
  
  if(startDraw){ // closes path if startDraw is false: this happens when if mousedowns runs whilst closedPath = true
   bufferCtx.lineTo(mousePos.x, mousePos.y);
   }else if(pointsArray[0]) {
    bufferCtx.closePath(); 
    customShapeGen();
    pointsArray = [];
   }
  bufferCtx.stroke();
  if(pointsArray[0]){
   if(distance(pointsArray[0][0] - mousePos.x, pointsArray[0][1] - mousePos.y) < closePathRadius){ // sets closedPath = true if the curso is hovering over the first set of points and also creates the lightgreen highlight
    bufferCtx.save();
    bufferCtx.fillStyle = 'lightgreen';
    bufferCtx.beginPath();
    bufferCtx.arc(pointsArray[0][0], pointsArray[0][1], closePathRadius, 0, 2*Math.PI);
    bufferCtx.fill();
    bufferCtx.restore();
    closedPath = true;
   }
  }
 }
          /** this section applies all of the changes and transformations that have been made to the shape **/
       
 if(customShapeArray[0]){
 
  for(var i = 0; i < customShapeArray.length; i++){
   bufferCtx.fillStyle = customShapeArray[i].colour;
   shadow(customShapeArray, i);
   //changeSize(customShapeArray, i);
   changeColour(customShapeArray, i);
   //rotateShape(customShapeArray, i);
   
   bufferCtx.save();
   bufferCtx.fillStyle = customShapeArray[i].colour;
   
   var Xpoint_0 = customShapeArray[i].vertices[0][0] + customShapeArray[i].X;
   var Ypoint_0 = customShapeArray[i].vertices[0][1] + customShapeArray[i].Y;
   
   
   var rotChange_0 = customShapeArray[i].rotater3(customShapeArray[i].sliderPosition);
   var Xchange_0 = rotChange_0[0][0];
   var Ychange_0 = rotChange_0[0][1];
   bufferCtx.beginPath();
   bufferCtx.moveTo(Xpoint_0 + Xchange_0, Ypoint_0 + Ychange_0); // first point of the custom shape is drawn here
   var rotChange = customShapeArray[i].rotater3(customShapeArray[i].sliderPosition);
   for(var j = 0; j < customShapeArray[i].vertices.length; j++){
    
    var Xpoint = customShapeArray[i].vertices[j][0] + customShapeArray[i].X;
    var Ypoint = customShapeArray[i].vertices[j][1] + customShapeArray[i].Y;
    
    var Xchange = rotChange[j][0];
    var Ychange = rotChange[j][1];
    
    
    /** Note: the vertices represent the shapes as unrotated and centred about the origin **/
    
    if(customShapeArray[i].vertices[j][2]){ // if a vertex has been clicked
     var projection = rotater2(0, 0, mousePos.x - customShapeArray[i].X, mousePos.y - customShapeArray[i].Y, -customShapeArray[i].sliderPosition*2*Math.PI/sliderButtonWidth); //the distance vector from the shape's centre (X,Y) to the cursor position (mousePos.x, mousePos.y) is rotated back into the unrotated frame
     var projectionX = projection[0]; // changes in the vertex's coordinates are projected back into into the unrotated frame
     var projectionY = projection[1];
     
     customShapeArray[i].vertices[j][0] = mousePos.x - customShapeArray[i].X + projectionX; // the projected changes are applied to the vertices to ensure that the are redrawn in the appropiate position
     customShapeArray[i].vertices[j][1] = mousePos.y - customShapeArray[i].Y + projectionY;
    }
    bufferCtx.lineTo(Xpoint + Xchange, Ypoint + Ychange);
  }
   
  bufferCtx.restore();
  bufferCtx.stroke();
  bufferCtx.fill();
  
 if(reShape){
  onReshape = false;
  for(var j = 0; j < customShapeArray[i].vertices.length; j++){
  
    var Xpoint = customShapeArray[i].vertices[j][0] + customShapeArray[i].X;
    var Ypoint = customShapeArray[i].vertices[j][1] + customShapeArray[i].Y;
    
    var Xchange = rotChange[j][0];
    var Ychange = rotChange[j][1];
     if(distance(mousePos.x - Xpoint - Xchange, mousePos.y - Ypoint - Ychange)< 5){ // detects when the cursor is hovering over a vertex and highlights it in grey
      onReshape = true;
      
      bufferCtx.fillStyle = 'grey';
      for(var k = 0; k < customShapeArray[i].vertices.length; k++){ //draws the small grey dots for each vertice
 
       var Xpoint = customShapeArray[i].vertices[k][0] + customShapeArray[i].X;
       var Ypoint = customShapeArray[i].vertices[k][1] + customShapeArray[i].Y;
       
       var Xchange = rotChange[k][0];
       var Ychange = rotChange[k][1];
       
       bufferCtx.beginPath();
       bufferCtx.arc(Xpoint + Xchange, Ypoint + Ychange, 4, 0, 2*Math.PI);
       bufferCtx.fill();
      }
      
      }
     }
    } 
    changeSize(customShapeArray, i);
    rotateShape(customShapeArray, i);
   }
  }
  
 //blueprint(customShapeArray, i);
 
 context.drawImage(bufferCanvas, 0, 0, canvas.width, canvas.height);
 
 if(saving){
  image.style.visibility = 'visible';
  
  // save canvas image as data url (png format by default)
  var dataURL = canvas.toDataURL();
  // set canvasImg image src to dataURL
  // so it can be saved as an image
  //document.getElementById('canvasImg').src = dataURL;
  image.src = dataURL;
 }
 //console.log(onReshape);
}

function blueprint(Array, i){
 for(var i = 0; i < Array.length; i++){
  bufferCtx.fillStyle = 'black';
  bufferCtx.beginPath();
  bufferCtx.arc(Array[i].X, Array[i].Y, 4, 0, 2*Math.PI);
  bufferCtx.fill();
  
  bufferCtx.beginPath();
  bufferCtx.arc(Array[i].X, Array[i].Y, Array[i].radius, 0, 2*Math.PI);
  bufferCtx.stroke();
  
  bufferCtx.strokeStyle = 'red';
  bufferCtx.beginPath();
  bufferCtx.arc(Array[i].X, Array[i].Y, Array[i].stretchRadius, 0, 2*Math.PI);
  bufferCtx.stroke();
  
  bufferCtx.strokeStyle = 'black';
  bufferCtx.fillStyle = 'white';
  bufferCtx.beginPath();
  bufferCtx.arc(Array[i].centroid[0], Array[i].centroid[1], 3, 0, 2*Math.PI);
  bufferCtx.fill();
  bufferCtx.stroke();
  }
}
  /* Adds the the drag and drop as well as shadow */
function shadow(Array, i){
 bufferCtx.fillStyle = Array[i].colour;
  bufferCtx.beginPath();  
   if(Array[i].selected){
    console.log('hello');
   //bufferCtx.beginPath();
   bufferCtx.lineWidth = 2;
   bufferCtx.shadowColor = 'rgba( 9, 9, 9, 0.3)';
   bufferCtx.shadowOffsetX = 10;
   bufferCtx.shadowOffsetY = 10;
   bufferCtx.shadowBlur = 10; 
   }else{
   bufferCtx.shadowColor = "transparent";
   bufferCtx.lineWidth = 1;
  } 
   if(dragging && Array[i].onObject){
   Array[i].X = mousePos.x + offcenter[0];
   Array[i].Y = mousePos.y + offcenter[1];
  }
}
/* Call resize() method when changing size */
function changeSize(Array, i){
  
  if(reSize && (Array[i].expand || Array[i].v_expand || Array[i].h_expand)){
   Array[i].resize();
  }
  
  /* Draws the re-size box */
  if(reSize && Array[i].expandBox){
   bufferCtx.save();
   //bufferCtx.globalCompositeOperation = "source-over";
   //bufferCtx.globalCompositeOperation = "destination-over"
   bufferCtx.fillStyle = 'white';
   bufferCtx.strokeStyle = 'black';
   bufferCtx.lineWidth = 0.5;
   var antLength = 7;
   var gap = 14;
   var ants = 0;
   //bufferCtx.globalAlpha = 0.3;
   
   bufferCtx.lineWidth = 0.7;
   
   /**(ants+1)*antLength + ants*(gap - antLength) = (antLength + ants*gap)**/
   
   /** top-left to top-right **/
   while((antLength + ants*gap) < 2*(Array[i].stretchRadius + selectSize)){
    bufferCtx.beginPath();
    bufferCtx.moveTo(Array[i].X - Array[i].stretchRadius - selectSize + gap*ants, Array[i].Y - Array[i].stretchRadius - selectSize);
    bufferCtx.lineTo(Array[i].X - Array[i].stretchRadius - selectSize + antLength + gap*ants, Array[i].Y - Array[i].stretchRadius - selectSize);
    bufferCtx.stroke();
    ants++;
   }
   ants = 0; /** bottom-left to bottom-right **/
   while((antLength + ants*gap) < 2*(Array[i].stretchRadius + selectSize)){
    bufferCtx.beginPath();
    bufferCtx.moveTo(Array[i].X - Array[i].stretchRadius - selectSize + gap*ants, Array[i].Y + Array[i].stretchRadius + selectSize);
    bufferCtx.lineTo(Array[i].X - Array[i].stretchRadius - selectSize + antLength + gap*ants, Array[i].Y + Array[i].stretchRadius + selectSize);
    bufferCtx.stroke();
    ants++;
   }
   ants = 0; /** top-left to top-right **/
   while((antLength + ants*gap) < 2*(Array[i].stretchRadius + selectSize)){
    bufferCtx.beginPath();
    bufferCtx.moveTo(Array[i].X - Array[i].stretchRadius - selectSize, Array[i].Y - Array[i].stretchRadius - selectSize + gap*ants);
    bufferCtx.lineTo(Array[i].X - Array[i].stretchRadius - selectSize, Array[i].Y - Array[i].stretchRadius - selectSize + antLength + gap*ants);
    bufferCtx.stroke();
    ants++;
   }
   ants = 0; /** bottom-right to bottom-right **/
   while((antLength + ants*gap) < 2*(Array[i].stretchRadius + selectSize)){
    bufferCtx.beginPath();
    bufferCtx.moveTo(Array[i].X + Array[i].stretchRadius + selectSize, Array[i].Y - Array[i].stretchRadius - selectSize + gap*ants);
    bufferCtx.lineTo(Array[i].X + Array[i].stretchRadius + selectSize, Array[i].Y - Array[i].stretchRadius - selectSize + antLength + gap*ants);
    bufferCtx.stroke();
    ants++;
   }
   bufferCtx.lineWidth = 1.5;
   bufferCtx.globalAlpha = 1
   
                    // this section draws the small white squares at the corners
   
   /** top-left **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   
   /** bottom-left **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   /** bottom-right **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   /** top-right **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   
   
                    // this section draws the small white squares at the sides
   
   /** top **/
   bufferCtx.strokeRect(Array[i].X - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize - smallBox/2, smallBox, smallBox);
   /** right **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, Array[i].Y - smallBox/2, smallBox, smallBox);
   /** bottom **/
   bufferCtx.strokeRect(Array[i].X - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - smallBox/2, Array[i].Y - Array[i].stretchRadius - selectSize + 2*(Array[i].stretchRadius + selectSize) - smallBox/2, smallBox, smallBox);
   /** left **/
   bufferCtx.strokeRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - smallBox/2, smallBox, smallBox);
   bufferCtx.fillRect(Array[i].X - Array[i].stretchRadius - selectSize - smallBox/2, Array[i].Y - smallBox/2, smallBox, smallBox);
   bufferCtx.restore();
  }
 }
/* Call pickColour() method when changing colour */
function changeColour(Array, i){
 if(colourChange && Array[i].onObject){
  Array[i].pickColour();
 }
}
/* Animating the slider */
function rotateShape(Array, i){
 if(rotate && Array[i].rotationLine){
  var startPoint = Array[i].X - sliderButtonWidth/2;
  var endPoint = Array[i].X + sliderButtonWidth/2;
  var yCoordinates = Array[i].Y + Array[i].radius + 45;
  var radius = 20;
  
  bufferCtx.save();
  //bufferCtx.globalAlpha = 0.3;
  bufferCtx.globalAlpha = 0.7;
  
  bufferCtx.shadowColor = 'rgba( 9, 9, 9, 0.4)';
  bufferCtx.shadowOffsetX = 10;
  bufferCtx.shadowOffsetY = 10;
  bufferCtx.shadowBlur = 10;
   
  bufferCtx.fillStyle = 'lightblue';
  bufferCtx.beginPath();
  bufferCtx.moveTo(startPoint, yCoordinates - radius);
  bufferCtx.arc(endPoint, yCoordinates, radius, -Math.PI/2, Math.PI/2);
  bufferCtx.lineTo(startPoint, yCoordinates + radius);
  bufferCtx.arc(startPoint, yCoordinates, radius, Math.PI/2, -Math.PI/2);
  bufferCtx.stroke();
  bufferCtx.fill();
  bufferCtx.restore();
  
  /** Horizontal slider line**/
  bufferCtx.save();
  
  bufferCtx.shadowColor = 'rgba( 9, 9, 9, 0.4)';
  bufferCtx.shadowOffsetX = 10;
  bufferCtx.shadowOffsetY = 10;
  bufferCtx.shadowBlur = 10;
  
  bufferCtx.beginPath();
  bufferCtx.moveTo(startPoint, yCoordinates);
  bufferCtx.lineTo(endPoint, yCoordinates);
  bufferCtx.stroke();
   
  /** Slider**/
  Array[i].slider[0] = startPoint + sliderPosition;
  Array[i].slider[1] = yCoordinates;
   
  /** Slider follows the cursor along the line **/
  if(rotate && onSlider && mousePos.x >= startPoint && mousePos.x <= endPoint){
   Array[i].slider[0] = mousePos.x;
   sliderPosition = mousePos.x - startPoint;
   Array[i].sliderPosition = mousePos.x - startPoint;
  }
  /** draws the actual slider **/
  bufferCtx.fillStyle = 'red';
  bufferCtx.beginPath();
  bufferCtx.moveTo(Array[i].slider[0] - 4, Array[i].slider[1] - 8);
  bufferCtx.lineTo(Array[i].slider[0] + 4, Array[i].slider[1] - 8);
  bufferCtx.lineTo(Array[i].slider[0], Array[i].slider[1]);
  bufferCtx.closePath();
  //bufferCtx.stroke();
  bufferCtx.fill();
  bufferCtx.restore();
 }
}

function circleDrawer(){
 bufferCtx.globalAlpha = 1;
 bufferCtx.lineWidth = 1
 if(!dragging && shapeSelection.circle[0] && mousePos.x <= canvas.width - 25 && mousePos.y <= canvas.height - 25 && !onObject){
  bufferCtx.beginPath();
  bufferCtx.globalAlpha = 0.1;
  bufferCtx.fillStyle = 'blue';
  bufferCtx.arc(mousePos.x, mousePos.y, 30, 0, 2*Math.PI);
  bufferCtx.stroke();
  bufferCtx.fill();
  }
 bufferCtx.lineWidth = 1;
 bufferCtx.strokeStyle = 'black';
 bufferCtx.globalAlpha = 1
 
 for(var i = 0; i < circleArray.length; i++){
 
  shadow(circleArray, i);
  changeSize(circleArray, i);
  changeColour(circleArray, i);
  
  bufferCtx.beginPath();
  bufferCtx.arc(circleArray[i].X, circleArray[i].Y, circleArray[i].radius, 0, 2*Math.PI);
  bufferCtx.stroke();
  bufferCtx.fill();
 }
}

function squareDrawer(){
  bufferCtx.globalAlpha = 1;
  /* Drawing the shape cursor */
  if(!dragging && shapeSelection.square[0] && mousePos.x <= canvas.width - 25 && mousePos.y <= canvas.height - 25 && !onObject){
  bufferCtx.globalAlpha = 0.1;
  bufferCtx.fillStyle = 'blue';
  bufferCtx.arc(mousePos.x, mousePos.y, 30, 0, 2*Math.PI);
  
  bufferCtx.beginPath();
  bufferCtx.moveTo(mousePos.x - 27.5, mousePos.y + 27.5);
  bufferCtx.lineTo(mousePos.x + 27.5, mousePos.y + 27.5);
  bufferCtx.lineTo(mousePos.x + 27.5, mousePos.y - 27.5);
  bufferCtx.lineTo(mousePos.x - 27.5, mousePos.y - 27.5);
  bufferCtx.closePath();
  
  bufferCtx.stroke();
  bufferCtx.fill();
  }
 
  bufferCtx.lineWidth = 1;
  bufferCtx.strokeStyle = 'black';
  bufferCtx.globalAlpha = 1
  
 for(var i = 0; i < squareArray.length; i++){
  bufferCtx.fillStyle = squareArray[i].colour;
  bufferCtx.lineWidth = 1;
  bufferCtx.strokeStyle = 'black';
  
  shadow(squareArray, i);
  changeSize(squareArray, i);
  changeColour(squareArray, i);
  rotateShape(squareArray, i);
  
            /**initial position of the shape**/
  var firstPoint = [squareArray[i].X - squareArray[i].side/2, squareArray[i].Y + squareArray[i].side/2]
  var secondPoint = [squareArray[i].X + squareArray[i].side/2, squareArray[i].Y + squareArray[i].side/2];
  var thirdPoint = [squareArray[i].X + squareArray[i].side/2, squareArray[i].Y - squareArray[i].side/2];
  var fourthPoint = [squareArray[i].X - squareArray[i].side/2, squareArray[i].Y - squareArray[i].side/2];
  
  /**calculates the orientation of the shape after rotating it through an angle (from initial position) based on the shapes sliderPosition**/
  firstPointChange = squareArray[i].rotater3(squareArray[i].sliderPosition)[0];
  secondPointChange = squareArray[i].rotater3(squareArray[i].sliderPosition)[1];
  thirdPointChange = squareArray[i].rotater3(squareArray[i].sliderPosition)[2];
  fourthPointChange = squareArray[i].rotater3(squareArray[i].sliderPosition)[3];
  
  bufferCtx.beginPath();
  bufferCtx.moveTo(firstPoint[0] + firstPointChange[0], firstPoint[1] + firstPointChange[1]);
  bufferCtx.lineTo(secondPoint[0] + secondPointChange[0], secondPoint[1] + secondPointChange[1]);
  bufferCtx.lineTo(thirdPoint[0] + thirdPointChange[0], thirdPoint[1] + thirdPointChange[1]);
  bufferCtx.lineTo(fourthPoint[0] + fourthPointChange[0], fourthPoint[1] + fourthPointChange[1]);
  bufferCtx.closePath();
  
  bufferCtx.stroke();
  bufferCtx.fill();
 }
}

function triangleDrawer(){
 bufferCtx.globalAlpha = 1;
 
  if(!dragging && shapeSelection.triangle[0] && mousePos.x <= canvas.width - 25 && mousePos.y <= canvas.height - 25 && !onObject){
  bufferCtx.globalAlpha = 0.1;
  bufferCtx.fillStyle = 'blue';
  bufferCtx.arc(mousePos.x, mousePos.y, 30, 0, 2*Math.PI);
  
  bufferCtx.beginPath();
  bufferCtx.moveTo(mousePos.x - 30, mousePos.y + Math.sqrt(3)/6 * 60);
  bufferCtx.lineTo(mousePos.x + 30, mousePos.y + Math.sqrt(3)/6 * 60);
  bufferCtx.lineTo(mousePos.x, mousePos.y - 2 * Math.sqrt(3)/6 * 60);
  bufferCtx.closePath();
  bufferCtx.stroke();
  bufferCtx.fill();
  }
  bufferCtx.strokeStyle = 'black';
  bufferCtx.globalAlpha = 1
  
 for(var i = 0; i < triangleArray.length; i++){
  bufferCtx.fillStyle = triangleArray[i].colour;
  bufferCtx.lineWidth = 1;
  bufferCtx.strokeStyle = 'black';
  
  shadow(triangleArray, i);
  changeSize(triangleArray, i);
  changeColour(triangleArray, i);
  rotateShape(triangleArray, i);
  
           /**initial position of the shape**/
  var firstPoint = [triangleArray[i].X - triangleArray[i].side/2, triangleArray[i].Y + Math.sqrt(3)/6 * triangleArray[i].side]
  var secondPoint = [triangleArray[i].X + triangleArray[i].side/2, triangleArray[i].Y + Math.sqrt(3)/6 * triangleArray[i].side];
  var thirdPoint = [triangleArray[i].X, triangleArray[i].Y - 2 * Math.sqrt(3)/6 * triangleArray[i].side];
  
  /**calculates the orientation of the shape after rotating it through an angle (from initial position) based on the shapes sliderPosition**/
  firstPointChange = triangleArray[i].rotater3(triangleArray[i].sliderPosition)[0];
  secondPointChange = triangleArray[i].rotater3(triangleArray[i].sliderPosition)[1];
  thirdPointChange = triangleArray[i].rotater3(triangleArray[i].sliderPosition)[2];
  
  bufferCtx.beginPath();
  bufferCtx.moveTo(firstPoint[0] + firstPointChange[0], firstPoint[1] + firstPointChange[1]);
  bufferCtx.lineTo(secondPoint[0] + secondPointChange[0], secondPoint[1] + secondPointChange[1]);
  bufferCtx.lineTo(thirdPoint[0] + thirdPointChange[0], thirdPoint[1] + thirdPointChange[1]);
  bufferCtx.closePath();
  
  bufferCtx.stroke();
  bufferCtx.fill();
 }
}

function shapeSelector(){
 shapeSelection.circle[0] = false;
 shapeSelection.square[0] = false;
 shapeSelection.triangle[0] = false;
 deletion = false;
 reSize = false;
 reShape = false; 
 colourChange = false;
 rotate = false;
 shapes = false;
 
 circles = false;
 triangles = false;
 squares = false;
 
 saving = false;
 options();
 
 $('#circle').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#circle').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#circle').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#circle').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#square').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#square').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#square').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#square').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#triangle').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#triangle').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#triangle').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#triangle').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#customShape').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#customShape').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#customShape').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#customShape').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#Re-Size').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#Re-Size').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#Re-Size').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#Re-Size').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#Re-Shape').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#Re-Shape').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#Re-Shape').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#Re-Shape').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#Rotate').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#Rotate').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#Rotate').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#Rotate').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#ChangeColour').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#ChangeColour').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#ChangeColour').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#ChangeColour').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#erase').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#erase').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#erase').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#erase').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 $('#save').css({'background-image': '-webkit-linear-gradient(bottom, black , #404040)'});  $('#save').css({'background-image': '-o-linear-gradient(bottom, black , #404040)'});  $('#save').css({'background-image': '-moz-linear-gradient(bottom, black , #404040)'});  $('#save').css({'background-image': 'linear-gradient(to bottom, #404040 ,black)'});
 
 image.style.visibility = 'hidden';
 PickColor.style.visibility = 'hidden';
}

function gradient(shape){
 shape.style.background = '-webkit-linear-gradient(top, black , #404040)'; 
 shape.style.background = '-o-linear-gradient(top, black , #404040)'; 
 shape.style.background = '-moz-linear-gradient(top, black , #404040 )'; 
 shape.style.background = 'linear-gradient(to top, #404040 ,black )'; 
}

function hover(shape){
 shape.style.background = '-webkit-linear-gradient(top, black , #404040)'; 
 shape.style.background = '-o-linear-gradient(top, black , #404040)'; 
 shape.style.background = '-moz-linear-gradient(top, black , #404040 )'; 
 shape.style.background = 'linear-gradient(to top, #404040 ,black )'; 
}
function leave(shapes, shape){
 if(!shapes){
 shape.style.background = '-webkit-linear-gradient(bottom, black , #404040)'; 
 shape.style.background = '-o-linear-gradient(bottom, black , #404040)'; 
 shape.style.background = '-moz-linear-gradient(bottom, black , #404040 )'; 
 shape.style.background = 'linear-gradient(to bottom, #404040 ,black )'; 
 }
}
function shapeSelect(){
 for(key in shapeSelection){
  if(shapeSelection[key][0]){
   return [shapeSelection[key][1](), shapeSelection[key][2]];
  }
 }
}
function colourPicker(){
 colours['transparent'][1] = false;
 colours['blue'][1] = false;
 colours['red'][1] = false;
 colours['yellow'][1] = false;
 colours['green'][1] = false;
 colours['white'][1] = false;
 colours['black'][1] = false;
 colours['lightblue'][1] = false;
 colours['lightgreen'][1] = false;
 colours['orange'][1] = false;
 colours['purple'][1] = false;
 colours['violet'][1] = false;
 colours['beige'][1] = false;
 colours['aqua'][1] = false;
 colours['grey'][1] = false;
 colours['pink'][1] = false;
}
function chooseColour(){
 for(colour in colours){
  if(colours[colour][1]){
   return colours[colour][0];
  }
 }
}
</script>
<title> Drawer </title>
</head>
<body id = 'body' onload = 'init()'>
<!--<div id = 'wrapper' >-->
<div id = 'bar'>
<div id = 'tipsSee'> See Tips </div>
<div class = 'shapes' id = 'save' onmouseover = "hover(save);" onmouseout = "leave(saving, save);" onclick = "if(saving){shapeSelector();}else{shapeSelector(); saving = true;} gradient(save);"><img class = 'icons' src = 'images/save.png'></img></div>
<div class = 'shapes' id = 'erase' onmouseover = "hover(erase);" onmouseout = "leave(deletion, erase);" onclick = "if(deletion){shapeSelector();}else{shapeSelector(); deletion = true;} gradient(erase);"><img class = 'icons' src = 'images/erase.png'></img></div>
<div class = 'shapes' id = 'circle' onmouseover = "hover(circle);" onmouseout = "leave(circles, circle);" onclick = " if(circles){shapeSelector();}else{shapeSelector();  circles = true; shapeSelection.circle[0] = true;} gradient(circle);"><img class = 'icons' src = 'images/shapes/circle.png'></img></div>
<div class = 'shapes' id = 'square' onmouseover = "hover(square);" onmouseout = "leave(squares, square);" onclick = "if(squares){shapeSelector();}else{shapeSelector(); squares = true; shapeSelection.square[0] = true;} gradient(square);"><img class = 'icons' src = 'images/shapes/square.png'></img></div>
<div class = 'shapes' id = 'triangle' onmouseover = "hover(triangle);" onmouseout = "leave(triangles, triangle);" onclick = "if(triangles){shapeSelector();}else{shapeSelector(); triangles = true; shapeSelection.triangle[0] = true;} gradient(triangle);"><img class = 'icons' src = 'images/shapes/triangle.png'></img></div>
<div class = 'shapes' id = 'customShape' onmouseover = "hover(customShape);" onmouseout = "leave(shapes, customShape);" onclick = "if(shapes){shapeSelector();}else{shapeSelector(); shapes = true;} gradient(customShape);"><img class = 'icons' src = 'images/shapes/custom.png'></img></div>
<div class = 'shapes' id = 'Re-Size' onmouseover = "hover(ReSize);" onmouseout = "leave(reSize, ReSize);" onclick = "if(reSize){shapeSelector();}else{shapeSelector(); reSize = true;} gradient(ReSize);"><img class = 'icons' src = 'images/resize.png'></img></div>
<div class = 'shapes' id = 'Re-Shape' onmouseover = "hover(ReShape);" onmouseout = "leave(reShape, ReShape);" onclick = "if(reShape){ shapeSelector();}else{shapeSelector(); reShape = true;} gradient(ReShape);"><img id = 'ReShaper' class = 'icons' src = 'images/shapes/reshape.png'></img></div>
<div class = 'shapes' id = 'Rotate' onmouseover = "hover(Rotate);" onmouseout = "leave(rotate, Rotate);" onclick = " if(rotate){shapeSelector();}else{shapeSelector(); rotate = true;} gradient(Rotate);"><img class = 'icons' src = 'images/rotate.png'></img></div>
 
<div id = 'colourful'>
<div class = 'shapes' id = 'ChangeColour'  onmouseover = "hover(ChangeColour);" onmouseout = "leave(colourChange, ChangeColour);" onclick = " if(colourChange){shapeSelector(); PickColor.style.visibility = 'invisible';}else{shapeSelector(); colourChange = true; PickColor.style.visibility = 'visible';} gradient(ChangeColour); colours.lightblue[1] = true; "><img class = 'icons' src = 'images/colour-wheel.png'></img></div>
<div id = 'PickColor'>
<table id = 'board'>
 <tr>
  <td><div id = 'transparent' class = 'pallet' style = 'text-align:center' onclick ='colourPicker(); colours.transparent[1] = true;'></div></td>
  <td><div id = 'blue' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.blue[1] = true;'></div></td>
  <td><div id = 'red' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.red[1] = true;'></div></td>
  <td><div id = 'yellow' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.yellow[1] = true;'></div></td>
 </tr>
 <tr>
  <td><div id = 'green' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.green[1] = true;'></div></td>
  <td><div id = 'white' class = 'pallet' style = 'text-align:center' onclick ='colourPicker(); colours.white[1] = true;'></div></td>
  <td><div id = 'black' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.black[1] = true;'></div></td>
  <td><div id = 'lightblue' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.lightblue[1] = true;'></div></td>
 </tr>
 <tr>
  <td><div id = 'lightgreen' class = 'pallet' style = 'text-align:center' onclick ='colourPicker(); colours.lightgreen[1] = true;'></div></td>
  <td><div id = 'orange' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.orange[1] = true;'></div></td>
  <td><div id = 'purple' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.purple[1] = true;'></div></td>
  <td><div id = 'violet' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.violet[1] = true;'></div></td>
 </tr>
 <tr>
  <td><div id = 'beige' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.beige[1] = true;'></div></td>
  <td><div id = 'aqua' class = 'pallet' style = 'text-align:center' onclick ='colourPicker(); colours.aqua[1] = true;'></div></td>
  <td><div id = 'grey' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.grey[1] = true;'></div></td>
  <td><div id = 'pink' class = 'pallet'style = 'text-align:center' onclick ='colourPicker(); colours.pink[1] = true;'></div></td>
 </tr>
</table>
</div>
</div>

</div>

<canvas id = 'canvas' onclick = 'shapeSelect()' ></canvas>
<img id="canvasImg" alt = "Right click to save me!">

<div id = "tips">
<div id='tipsRemove' onclick = "//tips.style.visibility = 'hidden';"> Remove Tips</div>

<center><div id ='tipsTitle'><h2>Tips</h2></div></center><p>
<div id = 'tipsWrapper'>
 <div class = 'tipsDiv'><img class = 'tipsImg' src = 'images/shapes/custom.png'></img></div>
 <p class = 'tipsPara'>To make your own shapes select the icon above, and then click on different parts of the canvas, complete the shape by clicking on the small green circle which appears when you hover over the start of the first line.</p>
 <hr><p>
 <div class = 'tipsDiv'><img class = 'tipsImg' src = 'images/erase.png'></img></div>
 <p class = 'tipsPara'>After selecting the 'delete' icon simply click on the shape that you wish to remove.</p>
 <hr><p>
 <div class = 'tipsDiv'><img id='tipsReshaper' class = 'tipsImg' src = 'images/shapes/reshape.png'></img></div>
 <p class = 'tipsPara'>After selecting the icon above, hover over any of the corners and all of them will be highlighted by small grey circles, simply drag an drop the corners to re-shape. (only works for the shapes you create) </p>
 <hr><p>
 <div class = 'tipsDiv'><img class = 'tipsImg' src = 'images/rotate.png'></img></div>
 <p class = 'tipsPara'>Select the icon above and the click on the shape you wish to rotate, then move the red triangular slider to rotate it.</p>
 <hr><p>
 <div class = 'tipsDiv'><img class = 'tipsImg' src = 'images/save.png'></img></div>
 <p class = 'tipsPara'> Firstly Select the icon above, and then to save your work; right-click the little image that appears in the top left corner.</p>
</div>
</div>
<!--</div>-->
</body>
</html>